import{g as B,a as T,b as u}from"./index.mJtI1-JJ.js";import{c as L,I as h,a as S,d as k}from"./imageCapture.Dc9Y53QL.js";import{g as U,u as P}from"./utils.eqLv3jM6.js";import"./url-utils.CYRnBsRd.js";const $=U(new URL(window.location.href)),n=P($),b=document.getElementById("loadingState"),C=document.getElementById("errorState"),E=document.getElementById("contentState"),x=document.getElementById("shareBtn"),g=document.getElementById("shareMenu"),p=document.getElementById("dropdownIcon"),d=document.getElementById("copyBtn"),l=document.getElementById("downloadBtn"),m=document.getElementById("statsCard");x?.addEventListener("click",t=>{t.stopPropagation(),g?.classList.toggle("hidden"),p?.classList.toggle("rotate-180")});document.addEventListener("click",t=>{x?.contains(t.target)||(g?.classList.add("hidden"),p?.classList.remove("rotate-180"))});function O(t){return`${(t/1e9).toFixed(2)}B`}async function q(){if(!(!d||!m))try{const t=d.querySelector("p"),e=t?.textContent||n("user.copyImage");t&&(t.textContent=n("user.copying"));const a=await L(m,{format:h.PNG,backgroundColor:"#000000"}),r=await S(a.blob);if(t)switch(r.type){case"success":t.textContent=n("user.copied");break;case"unsupported":t.textContent=n("user.unsupported");break;case"error":t.textContent=n("user.error");break}setTimeout(()=>{t&&(t.textContent=e),g?.classList.add("hidden"),p?.classList.remove("rotate-180")},2e3)}catch(t){console.error("Error al copiar:",t);const e=d.querySelector("p");e&&(e.textContent=n("user.error"),setTimeout(()=>{e.textContent=n("user.copyImage")},2e3))}}async function F(){if(!(!l||!m))try{const t=l.querySelector("p"),e=t?.textContent||n("user.downloadImage");t&&(t.textContent=n("user.downloading"));const a=new URL(window.location.href).searchParams.get("u")||"user",r=await L(m,{format:h.JPEG,backgroundColor:"#000000"}),s=await k(r.blob,`hive-stats-${a}`,h.JPEG);t&&(t.textContent=s.type==="success"?n("user.downloaded"):n("user.error")),setTimeout(()=>{t&&(t.textContent=e),g?.classList.add("hidden"),p?.classList.remove("rotate-180")},2e3)}catch(t){console.error("Error al descargar:",t);const e=l.querySelector("p");e&&(e.textContent=n("user.error"),setTimeout(()=>{e.textContent=n("user.downloadImage")},2e3))}}d?.addEventListener("click",q);l?.addEventListener("click",F);function G(t,e,a,r){const s={value:0};u.to(s,{value:e,duration:a,ease:"power2.out",onUpdate:()=>{t.textContent=Math.floor(s.value).toLocaleString("en-US")},onComplete:()=>{t.classList.add("achievement-bounce"),t.classList.add("achievement-glow"),setTimeout(()=>{t.classList.remove("achievement-bounce"),t.classList.remove("achievement-glow")},1500)}})}function M(t,e){const a={value:0};u.to(a,{value:e,duration:1.5,ease:"power2.out",onUpdate:()=>{t.textContent=`${a.value.toFixed(6)}%`},onComplete:()=>{t.classList.add("achievement-bounce"),t.classList.add("achievement-glow"),setTimeout(()=>{t.classList.remove("achievement-bounce"),t.classList.remove("achievement-glow")},1500)}})}async function f(){const e=new URL(window.location.href).searchParams.get("u");if(!e){w();return}try{const[a,r]=await Promise.all([B(),T(e)]),s=a.reduce((o,i)=>o+i.trx_count,0),v=r.total_operations,I=v/s*100,y=document.getElementById("userAvatar");y&&(y.src=`https://images.hive.blog/u/${e}/avatar/medium`),document.title=`@${e} - Ops by Hive`,j();const c=u.timeline();c.to("#userAvatar",{opacity:1,scale:1,duration:.6,ease:"back.out(1.7)"}),c.to("#username",{opacity:1,y:0,duration:.5,ease:"power2.out",onStart:()=>{const o=document.getElementById("username");o&&(o.textContent=`@${e}`,o.style.transform="translateY(-10px)")}},"-=0.2"),c.add(()=>{const o=document.getElementById("userOperations");o&&G(o,v,2)},"+=0.3"),c.add(()=>{const o=document.getElementById("percentage");o&&M(o,I)},"-=1"),c.add(()=>{const o=document.getElementById("globalTotal");if(o){const i={value:0};u.to(i,{value:s,duration:1.8,ease:"power2.out",onUpdate:()=>{o.textContent=O(i.value)},onComplete:()=>{o.classList.add("achievement-bounce"),o.classList.add("achievement-glow"),setTimeout(()=>{o.classList.remove("achievement-bounce"),o.classList.remove("achievement-glow")},1500)}})}},"-=1.2"),c.to("#hiveLogo",{opacity:.8,duration:.8,ease:"power2.out"},"-=0.5")}catch(a){console.error("Error loading user stats:",a),w()}}function j(){b?.classList.add("hidden"),C?.classList.add("hidden"),E?.classList.remove("hidden")}function w(){b?.classList.add("hidden"),E?.classList.add("hidden"),C?.classList.remove("hidden")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",f):f();
